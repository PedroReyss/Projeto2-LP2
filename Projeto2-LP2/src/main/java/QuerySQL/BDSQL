-- Criar database
CREATE DATABASE gestao_funcionarios;
USE gestao_funcionarios;

-- Tabela Departamentos
CREATE TABLE departamentos (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(100) NOT NULL,
    localizacao VARCHAR(100)
);

-- Tabela Cargos
CREATE TABLE cargos (
    id INT PRIMARY KEY AUTO_INCREMENT,
    titulo VARCHAR(100) NOT NULL,
    salario_base DECIMAL(10,2),
    bonus DECIMAL(10,2) DEFAULT 0
);

-- Tabela Funcionários Próprios (Módulo 1)
CREATE TABLE funcionarios (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(100) NOT NULL,
    cpf VARCHAR(14) UNIQUE,
    data_nascimento DATE,
    matricula VARCHAR(20) UNIQUE,
    salario_base DECIMAL(10,2),
    data_contratacao DATE,
    cargo_id INT,
    departamento_id INT,
    FOREIGN KEY (cargo_id) REFERENCES cargos(id),
    FOREIGN KEY (departamento_id) REFERENCES departamentos(id)
);

-- Tabela Histórico de Cargos
CREATE TABLE historico_cargos (
    id INT PRIMARY KEY AUTO_INCREMENT,
    funcionario_id INT,
    cargo_id INT,
    data_inicio DATE,
    data_fim DATE,
    FOREIGN KEY (funcionario_id) REFERENCES funcionarios(id),
    FOREIGN KEY (cargo_id) REFERENCES cargos(id)
);

-- Tabela Projetos
CREATE TABLE projetos (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(100) NOT NULL,
    descricao TEXT
);

-- Tabela Funcionário-Projeto (Associação M:N)
CREATE TABLE funcionario_projeto (
    funcionario_id INT,
    projeto_id INT,
    PRIMARY KEY (funcionario_id, projeto_id),
    FOREIGN KEY (funcionario_id) REFERENCES funcionarios(id),
    FOREIGN KEY (projeto_id) REFERENCES projetos(id)
);

-- Tabela Funcionários Terceirizados (Módulo 2)
CREATE TABLE funcionarios_terceirizados (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(100) NOT NULL,
    cpf VARCHAR(14) UNIQUE,
    data_nascimento DATE,
    empresa_prestadora VARCHAR(100),
    periodo_inicio DATE,
    periodo_fim DATE,
    responsavel_interno VARCHAR(100),
    departamento_id INT,
    FOREIGN KEY (departamento_id) REFERENCES departamentos(id)
);

-- Tabela Controle de Acesso Terceirizados
CREATE TABLE controle_acesso_terceirizados (
    id INT PRIMARY KEY AUTO_INCREMENT,
    terceirizado_id INT,
    data_acesso DATE,
    hora_entrada TIME,
    hora_saida TIME,
    FOREIGN KEY (terceirizado_id) REFERENCES funcionarios_terceirizados(id)
);

-- Tabela Visitantes (Módulo 3)
CREATE TABLE visitantes (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(100) NOT NULL,
    documento VARCHAR(50),
    motivo_visita TEXT,
    data_entrada DATETIME,
    data_saida DATETIME,
    funcionario_visitado VARCHAR(100),
    departamento_visitado VARCHAR(100),
    cracha_gerado BOOLEAN DEFAULT FALSE
);

-- Inserir dados iniciais
INSERT INTO departamentos (nome, localizacao) VALUES
('TI', 'São Paulo'),
('RH', 'Rio de Janeiro'),
('Financeiro', 'Belo Horizonte');

INSERT INTO cargos (titulo, salario_base, bonus) VALUES
('Gerente', 10000.00, 2000.00),
('Desenvolvedor', 5000.00, 1000.00),
('Analista', 7000.00, 1500.00);
